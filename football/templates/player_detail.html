{% extends 'base.html' %}
{% load static %}

{% block title %}{{ player.first_name }} {{ player.last_name }}{% endblock %}

{% block content %}

<!-- –®–∞–ø–∫–∞ –∏–≥—Ä–æ–∫–∞ -->
<div class="team-header">
    <div class="team-header-logo">
        <span>
            {{ player.first_name|slice:":1"|upper }}{{ player.last_name|slice:":1"|upper }}
        </span>
    </div>

    <div class="team-header-main">
        <div class="team-header-title-line">
            <h1 class="team-header-name">
                {{ player.first_name }} {{ player.last_name }}
            </h1>
            {% if player.position %}
                <span class="team-header-short">
                    {{ player.get_position_display }}
                    {% if current_number %}
                        ¬∑ ‚Ññ{{ current_number }}
                    {% endif %}
                </span>
            {% endif %}
        </div>
        <div class="team-header-meta">
            {% if current_team %}
                <span>–ö–æ–º–∞–Ω–¥–∞: {{ current_team.name }}</span>
            {% else %}
                <span class="muted">–ë–µ–∑ –∫–æ–º–∞–Ω–¥—ã</span>
            {% endif %}
            {% if player.birth_date %}
                ¬∑ <span>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {{ player.birth_date|date:"d.m.Y" }}</span>
            {% endif %}
        </div>
    </div>

    <div class="team-header-actions">
        <a href="{% url 'player_edit' player.id %}" class="btn btn-ghost btn-small">
            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
        </a>
        <a href="{% url 'player_delete' player.id %}" class="btn btn-danger btn-small">
            üóë –£–¥–∞–ª–∏—Ç—å
        </a>
    </div>
</div>

<div class="team-page-layout">
    <!-- –õ–ï–í–´–ô –ë–õ–û–ö: –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div>
        <section class="team-block">
            <div class="team-block-header">
                <div>
                    <h2 class="team-block-title">–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    <p class="team-block-subtitle">
                        –ø–æ –≤—Å–µ–º –º–∞—Ç—á–∞–º, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è / –≤—ã—Ö–æ–¥—ã –≤ —Å—Ç–∞—Ä—Ç
                    </p>
                </div>
            </div>

            <div class="team-stats-list">
                <div class="team-stat-row">
                    <span>–ú–∞—Ç—á–µ–π</span>
                    <span class="strong">{{ total_matches }}</span>
                </div>
                <div class="team-stat-row">
                    <span>–í —Å—Ç–∞—Ä—Ç–µ</span>
                    <span class="strong">{{ starts_count }}</span>
                </div>
                <div class="team-stat-row">
                    <span>–ì–æ–ª—ã</span>
                    <span class="strong">{{ total_goals }}</span>
                </div>
                <div class="team-stat-row">
                    <span>–ê—Å—Å–∏—Å—Ç—ã</span>
                    <span class="strong">{{ total_assists }}</span>
                </div>
                <div class="team-stat-row">
                    <span>–ñ—ë–ª—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</span>
                    <span class="strong">{{ total_yellow }}</span>
                </div>
                <div class="team-stat-row">
                    <span>–ö—Ä–∞—Å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</span>
                    <span class="strong">{{ total_red }}</span>
                </div>
            </div>
        </section>
    </div>

    <!-- –ü–†–ê–í–´–ô –ë–õ–û–ö: –∏–Ω—Ñ–æ -->
    <div>
        <section class="team-block">
            <div class="team-block-header">
                <div>
                    <h2 class="team-block-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∏–≥—Ä–æ–∫–µ</h2>
                    <p class="team-block-subtitle">
                        –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
                    </p>
                </div>
            </div>

            <div class="team-stats-list">
                <div class="team-stat-row">
                    <span>–ò–º—è</span>
                    <span class="strong">
                        {{ player.first_name }} {{ player.last_name }}
                    </span>
                </div>
                <div class="team-stat-row">
                    <span>–ü–æ–∑–∏—Ü–∏—è</span>
                    <span class="strong">
                        {% if player.position %}
                            {{ player.get_position_display }}
                        {% else %}
                            <span class="muted">-</span>
                        {% endif %}
                    </span>
                </div>
                <div class="team-stat-row">
                    <span>–ö–æ–º–∞–Ω–¥–∞</span>
                    <span class="strong">
                        {% if current_team %}
                            {{ current_team.name }}
                        {% else %}
                            <span class="muted">–Ω–µ—Ç</span>
                        {% endif %}
                    </span>
                </div>
                <div class="team-stat-row">
                    <span>–ù–æ–º–µ—Ä –≤ –∫–æ–º–∞–Ω–¥–µ</span>
                    <span class="strong">
                        {% if current_team and current_number %}
                            ‚Ññ{{ current_number }}
                        {% elif current_team %}
                            <span class="muted">–Ω–µ —É–∫–∞–∑–∞–Ω</span>
                        {% else %}
                            <span class="muted">‚Äî</span>
                        {% endif %}
                    </span>
                </div>
                <div class="team-stat-row">
                    <span>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</span>
                    <span class="strong">
                        {% if player.birth_date %}
                            {{ player.birth_date|date:"d.m.Y" }}
                        {% else %}
                            <span class="muted">–Ω–µ —É–∫–∞–∑–∞–Ω–æ</span>
                        {% endif %}
                    </span>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–∞—Ç—á–∞–º -->
<section class="team-block" style="margin-top:14px;">
    <div class="team-block-header">
        <div>
            <h2 class="team-block-title">–ú–∞—Ç—á–∏ –∏–≥—Ä–æ–∫–∞</h2>
            <p class="team-block-subtitle">
                —Å—Ç–∞—Ä—Ç / —É—á–∞—Å—Ç–∏–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –∫–∞–∂–¥–æ–º—É –º–∞—Ç—á—É
            </p>
        </div>
    </div>

    {% if matches_stats %}
        <table class="table team-matches-table">
            <thead>
            <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–ú–∞—Ç—á</th>
                <th>–ö–æ–º–∞–Ω–¥–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ì–æ–ª—ã</th>
                <th>–ê—Å—Å–∏—Å—Ç—ã</th>
                <th>–ñ–ö</th>
                <th>–ö–ö</th>
            </tr>
            </thead>
            <tbody>
            {% for row in matches_stats %}
                <tr>
                    <td>{{ row.match.date|date:"d.m.Y H:i" }}</td>
                    <td>
                        <a href="{% url 'match_detail' row.match.id %}" class="link">
                            {{ row.match.home_team.name }} ‚Äî {{ row.match.away_team.name }}
                        </a>
                    </td>
                    <td>
                        {% if row.team %}
                            {{ row.team.name }}
                        {% else %}
                            <span class="muted">-</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if row.is_starting %}
                            <span class="badge badge-soft">–°—Ç–∞—Ä—Ç</span>
                        {% else %}
                            <span class="badge">–ò–≥—Ä–∞–ª</span>
                        {% endif %}
                    </td>
                    <td class="cell-num strong">{{ row.goals }}</td>
                    <td class="cell-num strong">{{ row.assists }}</td>
                    <td class="cell-num">{{ row.yellow }}</td>
                    <td class="cell-num">{{ row.red }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="muted">
            –ü–æ–∫–∞ –Ω–µ—Ç –º–∞—Ç—á–µ–π —Å —É—á–∞—Å—Ç–∏–µ–º —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (–ø–æ —Å–æ–±—ã—Ç–∏—è–º / –ø—Ä–æ—Ç–æ–∫–æ–ª—É).
        </p>
    {% endif %}
</section>

{% endblock %}
